const Zen=function(){const e=()=>{document.querySelector("html").style.opacity=1},n=e=>{401===e&&console.warn(e)},t=()=>Math.floor(1e10*Math.random()),o=(e,n)=>new Promise((o,i)=>{let a=n?"?ver="+t():"",c=document.createElement("script");c.src=e+a,c.onload=(()=>o(c)),c.onerror=(()=>i(new Error(`Script load error for ${src}`))),document.head.appendChild(c)}),i="AIzaSyCs0bWsRAA_VLBM2xKFjhL-k2cEdxcRqL0",a=async e=>{window.zen={}||zen,window.zen.config=e,window.zen.preview=!1;let n=h(),i=e.config;if(""!==n){const t=await f(e.config,n);i=200===t.status?t.file:e.config,200===t.status&&u(n),window.zen.preview=!0}try{const n=await fetch(`${e.cdnPath}/dist/data/${i}?version=${t()}`),a=await n.json();window.zen.d=JSON.parse(JSON.stringify(a)).config,o(window.zen.config.scaffold,!0)}catch(e){console.warn(e)}},c=e=>{if(navigator.cookieEnabled)return window.localStorage.getItem(e)},s=(e,n)=>{if(navigator.cookieEnabled)return window.localStorage.setItem(e,n)},d=(e,n)=>c(e)&&"null"!==c(e)?c(e):(s(e,n),n),r=(e,n)=>e.indexOf(n)>-1,l=({cdnPath:e,zenId:n})=>new Promise(t=>{c("zenFp")&&t(),d("zenId",n);let i=o(`${e}/dist/iife.min.js`);i.then(()=>{let e=FingerprintJS.load();e.then(e=>e.get()).then(e=>{s("zenFp",e.visitorId),t()})})}),w=e=>new URLSearchParams(window.location.search).get(e),h=()=>w("preview")?w("preview"):"",p=(e,n)=>`${e.split("/config")[0]}/config${n.toLocaleLowerCase()}.json`,u=e=>{let n=document.querySelectorAll("a");n.forEach(n=>{n.href.indexOf(window.location.origin)>-1&&(n.href=n.href+"?preview="+e)})},f=async(e,n)=>{let o=p(e,n),i={status:404,file:""};try{const e=await fetch(`https://content.zenimpact.io/dist/data/${o}?ver=${t()}`);await e.json();i.file=o,i.status=e.status}catch(e){console.warn(e)}return i},m=()=>"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)}),x=e=>new Promise(n=>{fetch(`https://content.zenimpact.io/dist/data/${e}/client.json?ver=${t()}`).then(e=>e.json()).then(e=>{n(e[window.location.host])}).catch(e=>console.warn(e))}),z=async e=>{let n=await x(e.client),t={client:e.client,site:null};return void 0===n?t:n.hasOwnProperty("siteId")?{client:e.client,site:n.siteId}:t},$=e=>-1!==e.indexOf("gw"),I=e=>$(e)?{"Content-Type":"application/json","x-api-key":window.token}:{"Content-Type":"application/json",Authorization:"Bearer "+window.token},v=(e,n)=>{$(e)?(window.token=i,n(i)):fetch("https://one-dev.zenimpact.dev/nonce").then(e=>e.json()).then(e=>{window.token=e.token,n(e.token)}).catch(e=>console.warn(e))},g=o=>{const{client:i,site:c}=o,s=`https://content.zenimpact.io/dist/data/${i}/${c}/init.json?ver=${t()}`;fetch(s,{method:"GET"}).then(e=>(n(e.status),e.json())).then(n=>{var t=n[window.location.host];if(t.zenId=m(),!t.isActive)return e(),!1;v(t.endpoint,e=>{j(t,e),a(t)})}).catch(e=>console.warn(e))},y=(e,n)=>(null==c("zenId")&&E(e.endpoint,e.zenId,n),e.zenId),j=async(e,n)=>{await y(e,n);let t=!!c("zenId")&&await S(e,n);t||(r(e.options,"print")&&await l(e),r(e.options,"302")?k(e,n,!0):k(e,n,!1))},S=({endpoint:e,zenId:n,siteId:t},o)=>new Promise(o=>{fetch(`${e}/validate?zenId=${c("zenId")}&siteId=${t}`,{method:"POST",headers:I(e)}).then(e=>e.json()).then(e=>{e.status||(s("zenId",n),o(!1))}).catch(e=>console.warn(e))}),k=({endpoint:e,zenId:n,hub:t,siteId:o},i,a)=>{const s="*";let r=d("zenId",n),l=document.createElement("iframe"),w=c("zenFp")?`&print=${c("zenFp")}`:"";l.height=0,l.width=0,l.id="zenapseHubId",l.src=`${t}/set?zenId=${r}&siteId=${o}${w}&token=${i}`,l.onload=(()=>{l.contentWindow.postMessage("check",s)}),window.addEventListener("message",n=>{const c=document.getElementById("zenapseHubId").contentWindow;if(n.source===c){let c=P(n.data);c||a&&b(t,r,o,i,e)}},{once:!0}),setTimeout(()=>{document.body.append(l)},5e3)},P=e=>"object"==typeof e&&void 0!==e.zenId,b=(e,n,t,o)=>{let i=document.createElement("form"),a=c("zenFp");i.action=`${e}/zenhub`,i.id="hubform",i.method="POST",i.innerHTML=`<input name="zenId" value="${n}" />\n                      <input name="site" value="${t}" />\n                      <input name="token" value="${o}" />\n                      ${a?`<input name="print" value="${a}" />`:""}`,document.body.append(i),i.submit()},E=(e,n)=>{fetch(`${e}/zenid?zenId=${n}`,{method:"POST",headers:I(e)}).then(e=>e.json()).catch(e=>console.warn(e))},O=async e=>!!e.hasOwnProperty("client")&&(e.hasOwnProperty("site")||(e=await z(e)),!!e.site&&void g(e,i));return{init:O}}();